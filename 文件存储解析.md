# 文件存储解析

目前我服务器的目录规划：项目工程目录/root/kt/mrdocs，部署相关目录：/root/kt/mrdocs/deployment（手动scp上传上去的），你告诉我，我部署起来后， 文件存储位置是什么样子的



  # 部署脚本位置
  SCRIPT_DIR = /root/kt/mrdocs/deployment/scripts

  # 项目目录 = 脚本目录的上上级 (../../)
  PROJECT_DIR = /root/kt/mrdocs

#   🗂️ 部署后完整目录结构

  ```
  /root/kt/mrdocs/                     # 项目根目录（自动确定）
    ├── deployment/                      # 部署相关文件（你手动上传的）
    │   ├── scripts/
    │   │   ├── deploy_safe_mrdoc.sh    # 安全部署脚本
    │   │   └── ubuntu_prepare.sh       # 环境准备脚本
    │   ├── config/
    │   └── SAFE_DEPLOYMENT_PLAN.md
    ├── media/              ⬅️ **上传文件存储位置**
    │   ├── uploads/                     # 文档附件
    │   ├── images/                      # 图片资源
    │   ├── documents/                   # 文档文件
    │   └── temp/                        # 临时文件
    ├── logs/               ⬅️ **应用日志存储**
    ├── static/             ⬅️ **静态文件存储**
    ├── config/             ⬅️ **配置文件存储**
    ├── docker/
    │   ├── docker-compose.yml
    │   └── Dockerfile
    ├── manage.py                        # Django管理脚本（克隆源码）
    ├── requirements.txt                 # 依赖文件（克隆源码）
    └── ...                             # 其他源码文件
  ```



  📊 文件存储详细说明

#   🎯 上传文件存储位置

  服务器存储路径：
 ```
  /root/kt/mrdocs/media/              # 所有通过web端上传的文件
   ├── uploads/                        # 文档附件（PDF、Word等）
   ├── images/                         # 图片资源（PNG、JPG等）
   ├── documents/                      # 文档导出文件
   └── temp/                          # 临时上传文件
 ```



#   🔗 Docker卷映射关系

docker-compose.yml 中的卷映射

 ```yaml
  volumes:
 
    - ./media:/app/media              # /root/kt/mrdocs/media ↔ 容器/app/media
      - ./logs:/app/logs                # /root/kt/mrdocs/logs ↔ 容器/app/logs
        - ./static:/app/static            # /root/kt/mrdocs/static ↔ 容器/app/static
        - ./config:/app/config            # /root/kt/mrdocs/config ↔ 容器/app/config
 ```



#   🛠️ 文件管理操作

  📂 查看上传文件

  ## 查看所有上传文件
  ls -la /root/kt/mrdocs/media/

  ## 查看目录大小
  du -sh /root/kt/mrdocs/media/

  ## 按类型查看文件
  find /root/kt/mrdocs/media/ -name "*.pdf" -type f
  find /root/kt/mrdocs/media/ -name "*.jpg" -o -name "*.png" -type f

  💾 备份上传文件

  ## 备份所有上传文件
  cd /root/kt/
  tar -czf mrdoc_media_backup_$(date +%Y%m%d).tar.gz mrdocs/media/

  ## 定期备份脚本（每天凌晨2点）
  echo "0 2 * * * tar -czf /backup/mrdoc_media_\$(date +\%Y\%m\%d).tar.gz -C /root/kt mrdocs/media/" | crontab -

  🧹 清理临时文件

  ## 清理7天前的临时文件
  find /root/kt/mrdocs/media/temp/ -type f -mtime +7 -delete

  ## 清理大文件（超过100MB）
  find /root/kt/mrdocs/media/ -size +100M -type f -ls



#   🔒 安全性说明

  ✅ 存储安全特点

  - ✅ 独立存储 - 文件存储在 /root/kt/mrdocs/media/，与系统其他服务完全隔离
  - ✅ 持久化 - 容器重启/更新不影响已上传文件
  - ✅ 便于管理 - 所有文件集中在一个目录，便于备份和迁移
  - ✅ 权限控制 - 文件权限继承 /root/kt/ 目录权限设置

  总结：部署后，所有通过MrDoc web端上传的附件和素材都会存储在 /root/kt/mrdocs/media/ 目录中。 📁✅